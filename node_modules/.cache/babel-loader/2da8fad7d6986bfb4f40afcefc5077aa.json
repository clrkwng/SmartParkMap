{"ast":null,"code":"import _assertThisInitialized from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/assertThisInitialized\";\nimport _classCallCheck from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nimport _slicedToArray from \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\Wei\\\\Desktop\\\\SmartParkWebApp\\\\SmartParkMap\\\\src\\\\App.js\";\nimport React, { useState, useEffect } from \"react\";\nimport { withGoogleMap, withScriptjs, GoogleMap, Marker, InfoWindow } from \"react-google-maps\";\nimport { compose, withProps } from \"recompose\";\nimport * as parkData from \"./data/parking_meters.json\";\nimport mapStyles from \"./mapStyles\";\nimport Geocode from \"react-geocode\";\nimport KDBush from 'kdbush';\nvar API_KEY = 'AIzaSyCcq9sfKruEgeckm_yRwLmBdkOFCSQ3SLA';\nGeocode.setApiKey(API_KEY);\nvar meterKD = new KDBush(parkData, function (p) {\n  return p.lat;\n}, function (p) {\n  return p.long;\n}, 100000, Float64Array);\n\nfunction Map(props) {\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      selectedPark = _useState2[0],\n      setSelectedPark = _useState2[1];\n\n  useEffect(function () {\n    var listener = function listener(e) {\n      if (e.key === \"Escape\") {\n        setSelectedPark(null);\n      }\n    };\n\n    window.addEventListener(\"keydown\", listener);\n    return function () {\n      window.removeEventListener(\"keydown\", listener);\n    };\n  }, []);\n  return React.createElement(GoogleMap, {\n    defaultZoom: 10,\n    defaultCenter: props.point,\n    defaultOptions: {\n      styles: mapStyles\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 37\n    },\n    __self: this\n  }, props.results.map(function (park) {\n    return React.createElement(Marker, {\n      key: park.meter_number,\n      position: {\n        lat: park.lat,\n        lng: park.long\n      },\n      onClick: function onClick() {\n        setSelectedPark(park);\n      },\n      icon: {\n        url: \"/parking_meter.svg\",\n        scaledSize: new window.google.maps.Size(40, 40)\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 43\n      },\n      __self: this\n    });\n  }), selectedPark && React.createElement(InfoWindow, {\n    onCloseClick: function onCloseClick() {\n      setSelectedPark(null);\n    },\n    position: {\n      lat: selectedPark.geometry.coordinates[1],\n      lng: selectedPark.geometry.coordinates[0]\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, selectedPark.properties.NAME), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, selectedPark.properties.DESCRIPTION))));\n}\n\nvar MapWrapped = compose(withProps({\n  googleMapURL: \"https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=\".concat(API_KEY),\n  //   ${process.env.REACT_APP_GOOGLE_KEY}\n  // `}\n  loadingElement: React.createElement(\"div\", {\n    style: {\n      height: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }),\n  containerElement: React.createElement(\"div\", {\n    style: {\n      height: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }),\n  mapElement: React.createElement(\"div\", {\n    style: {\n      height: \"100%\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  })\n}), withScriptjs, withGoogleMap)(Map);\n\nfunction MapDisplay(props) {\n  return React.createElement(\"div\", {\n    style: {\n      textAlign: \"center\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    style: {\n      width: \"80vw\",\n      height: \"80vh\",\n      display: \"inline-block\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(MapWrapped, {\n    point: props.point,\n    results: props.results,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  })));\n}\n\nvar radius = 1;\n\nvar SearchPage =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(SearchPage, _React$Component);\n\n  function SearchPage(props) {\n    var _this;\n\n    _classCallCheck(this, SearchPage);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(SearchPage).call(this, props));\n    _this.state = {\n      point: {\n        lat: 39.961178,\n        lng: -82.998795\n      },\n      results: [],\n      test: \"empty\"\n    };\n    return _this;\n  }\n\n  _createClass(SearchPage, [{\n    key: \"findResults\",\n    value: function findResults(address) {\n      var _this2 = this;\n\n      Geocode.fromAddress(address).then(function (response) {\n        var _response$results$0$g = response.results[0].geometry.location,\n            lat = _response$results$0$g.lat,\n            lng = _response$results$0$g.lng; // this.setState({test: `${lat} ${lng}`})\n\n        return {\n          lat: lat,\n          lng: lng\n        };\n      }).then(function (_ref) {\n        var lat = _ref.lat,\n            lng = _ref.lng;\n\n        _this2.setState({\n          test: \"\".concat(lat, \" \").concat(lng)\n        });\n\n        var results = meterKD.within(lat, lng, radius).map(function (id) {\n          return parkData.features[id];\n        });\n\n        _this2.setState({\n          point: {\n            lat: lat,\n            lng: lng\n          },\n          results: results\n        });\n      }).then(function () {\n        if (_this2.state.results.length < 1) {\n          _this2.setState({\n            test: \"no results\"\n          });\n        } else {\n          _this2.setState({\n            test: _this2.state.results\n          });\n        }\n      }).catch(function (error) {\n        _this2.setState({\n          test: \"error\"\n        });\n\n        console.error(error);\n        return _this2.state.point;\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149\n        },\n        __self: this\n      }, React.createElement(TitleBar, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 152\n        },\n        __self: this\n      }, React.createElement(SearchBar, {\n        findResults: this.findResults.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 153\n        },\n        __self: this\n      })), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 155\n        },\n        __self: this\n      }, this.state.test), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 158\n        },\n        __self: this\n      }, React.createElement(MapDisplay, {\n        point: this.state.point,\n        results: this.state.results,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 159\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return SearchPage;\n}(React.Component);\n\nexport { SearchPage as default };\n\nvar TitleBar =\n/*#__PURE__*/\nfunction (_React$Component2) {\n  _inherits(TitleBar, _React$Component2);\n\n  function TitleBar() {\n    _classCallCheck(this, TitleBar);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TitleBar).apply(this, arguments));\n  }\n\n  _createClass(TitleBar, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"titleBar\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        style: {\n          fontSize: \"xx-large\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 171\n        },\n        __self: this\n      }, \"Honda SmartPark\"), React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }, React.createElement(Menu, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return TitleBar;\n}(React.Component);\n\nvar SearchBar =\n/*#__PURE__*/\nfunction (_React$Component3) {\n  _inherits(SearchBar, _React$Component3);\n\n  function SearchBar(props) {\n    var _this3;\n\n    _classCallCheck(this, SearchBar);\n\n    _this3 = _possibleConstructorReturn(this, _getPrototypeOf(SearchBar).call(this, props));\n    _this3.state = {\n      value: '',\n      prevValue: ''\n    };\n    _this3.handleChange = _this3.handleChange.bind(_assertThisInitialized(_this3));\n    _this3.handleSubmit = _this3.handleSubmit.bind(_assertThisInitialized(_this3));\n    _this3.onSubmit = _this3.props.findResults;\n    return _this3;\n  }\n\n  _createClass(SearchBar, [{\n    key: \"handleChange\",\n    value: function handleChange(event) {\n      this.setState({\n        value: event.target.value\n      });\n    }\n  }, {\n    key: \"handleSubmit\",\n    value: function handleSubmit(event) {\n      if (this.state.prevValue !== this.state.value) {\n        this.onSubmit(this.state.value);\n        this.setState({\n          prevValue: this.state.value\n        });\n      }\n\n      event.preventDefault();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 209\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        onSubmit: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(\"input\", {\n        type: \"text\",\n        value: this.state.value,\n        onChange: this.handleChange,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }), React.createElement(\"button\", {\n        onClick: this.handleSubmit,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212\n        },\n        __self: this\n      }, \"Search\")));\n    }\n  }]);\n\n  return SearchBar;\n}(React.Component);\n\nvar TimeBar =\n/*#__PURE__*/\nfunction (_React$Component4) {\n  _inherits(TimeBar, _React$Component4);\n\n  function TimeBar() {\n    _classCallCheck(this, TimeBar);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(TimeBar).apply(this, arguments));\n  }\n\n  return TimeBar;\n}(React.Component);\n\nvar Menu =\n/*#__PURE__*/\nfunction (_React$Component5) {\n  _inherits(Menu, _React$Component5);\n\n  function Menu() {\n    _classCallCheck(this, Menu);\n\n    return _possibleConstructorReturn(this, _getPrototypeOf(Menu).apply(this, arguments));\n  }\n\n  _createClass(Menu, [{\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, \"Menu\");\n    }\n  }]);\n\n  return Menu;\n}(React.Component);","map":{"version":3,"sources":["C:/Users/Wei/Desktop/SmartParkWebApp/SmartParkMap/src/App.js"],"names":["React","useState","useEffect","withGoogleMap","withScriptjs","GoogleMap","Marker","InfoWindow","compose","withProps","parkData","mapStyles","Geocode","KDBush","API_KEY","setApiKey","meterKD","p","lat","long","Float64Array","Map","props","selectedPark","setSelectedPark","listener","e","key","window","addEventListener","removeEventListener","point","styles","results","map","park","meter_number","lng","url","scaledSize","google","maps","Size","geometry","coordinates","properties","NAME","DESCRIPTION","MapWrapped","googleMapURL","loadingElement","height","containerElement","mapElement","MapDisplay","textAlign","width","display","radius","SearchPage","state","test","address","fromAddress","then","response","location","setState","within","id","features","length","catch","error","console","findResults","bind","Component","TitleBar","fontSize","SearchBar","value","prevValue","handleChange","handleSubmit","onSubmit","event","target","preventDefault","TimeBar","Menu"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  withGoogleMap,\r\n  withScriptjs,\r\n  GoogleMap,\r\n  Marker,\r\n  InfoWindow\r\n} from \"react-google-maps\";\r\nimport { compose, withProps } from \"recompose\";\r\nimport * as parkData from \"./data/parking_meters.json\";\r\nimport mapStyles from \"./mapStyles\";\r\nimport Geocode from \"react-geocode\";\r\nimport KDBush from 'kdbush';\r\n\r\nconst API_KEY = 'AIzaSyCcq9sfKruEgeckm_yRwLmBdkOFCSQ3SLA';\r\nGeocode.setApiKey(API_KEY);\r\n\r\nconst meterKD = new KDBush(parkData, p =>p.lat, p=>p.long, 100000, Float64Array);\r\n\r\nfunction Map(props) {\r\n  const [selectedPark, setSelectedPark] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const listener = e => {\r\n      if (e.key === \"Escape\") {\r\n        setSelectedPark(null);\r\n      }\r\n    };\r\n    window.addEventListener(\"keydown\", listener);\r\n\r\n    return () => {\r\n      window.removeEventListener(\"keydown\", listener);\r\n    };\r\n  }, []);\r\n\r\n  return (\r\n    <GoogleMap\r\n      defaultZoom={10}\r\n      defaultCenter={props.point}\r\n      defaultOptions={{ styles: mapStyles }}\r\n      >\r\n      {props.results.map(park => (\r\n        <Marker\r\n          key={park.meter_number}\r\n          position={{\r\n            lat: park.lat,\r\n            lng: park.long\r\n          }}\r\n          onClick={() => {\r\n            setSelectedPark(park);\r\n          }}\r\n          icon={{\r\n            url: `/parking_meter.svg`,\r\n            scaledSize: new window.google.maps.Size(40, 40)\r\n          }}\r\n        />\r\n      ))}\r\n\r\n      {selectedPark && (\r\n        <InfoWindow\r\n          onCloseClick={() => {\r\n            setSelectedPark(null);\r\n          }}\r\n          position={{\r\n            lat: selectedPark.geometry.coordinates[1],\r\n            lng: selectedPark.geometry.coordinates[0]\r\n          }}\r\n        >\r\n          <div>\r\n            <h2>{selectedPark.properties.NAME}</h2>\r\n            <p>{selectedPark.properties.DESCRIPTION}</p>\r\n          </div>\r\n        </InfoWindow>\r\n      )}\r\n    </GoogleMap>\r\n  );\r\n}\r\n\r\nconst MapWrapped = compose(\r\n  withProps({\r\n    googleMapURL: `https://maps.googleapis.com/maps/api/js?v=3.exp&libraries=geometry,drawing,places&key=${API_KEY}`,\r\n      //   ${process.env.REACT_APP_GOOGLE_KEY}\r\n      // `}\r\n      loadingElement: <div style={{ height: `100%` }} />,\r\n      containerElement: <div style={{ height: `100%` }} />,\r\n      mapElement: <div style={{ height: `100%` }} />\r\n  }),\r\n  withScriptjs,\r\n  withGoogleMap\r\n)(Map);\r\n\r\nfunction MapDisplay(props) {\r\n  return (\r\n    <div style={{ textAlign:\"center\" }}>\r\n    <div style={{ width: \"80vw\", height: \"80vh\", display:\"inline-block\" }}>\r\n      <MapWrapped point={props.point} results={props.results}/>\r\n    </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst radius = 1;\r\n\r\nexport default class SearchPage extends React.Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n          point: {lat: 39.961178, lng: -82.998795},\r\n          results: [],\r\n          test: \"empty\"\r\n      };\r\n  }\r\n\r\n  findResults(address) {\r\n    Geocode.fromAddress(address).then(\r\n      response => {\r\n        const {lat, lng} = response.results[0].geometry.location;\r\n        // this.setState({test: `${lat} ${lng}`})\r\n        return {lat, lng};\r\n      },\r\n    ).then(\r\n      ({lat, lng})=>{\r\n        this.setState({test: `${lat} ${lng}`});\r\n        const results = meterKD.within(lat, lng, radius).map(id => parkData.features[id]);\r\n        this.setState({\r\n          point: {lat: lat, lng: lng},\r\n          results: results});\r\n      }\r\n    ).then(\r\n      ()=>{\r\n        if (this.state.results.length < 1) {\r\n          this.setState({test: \"no results\"});\r\n        } else {\r\n          this.setState({test: this.state.results});\r\n        }\r\n      }\r\n    ).catch(\r\n      error => {\r\n        this.setState({test: \"error\"});\r\n        console.error(error);\r\n        return this.state.point;\r\n      }\r\n    );\r\n  }\r\n  \r\n  render() {\r\n      return (\r\n          <div>\r\n              <div>\r\n                <TitleBar/>\r\n              </div>\r\n              <div>\r\n                <SearchBar findResults={this.findResults.bind(this)}/>\r\n              </div>\r\n              <div>\r\n                {this.state.test}\r\n              </div>\r\n              <div>\r\n                <MapDisplay point={this.state.point} results={this.state.results}/>\r\n              </div>\r\n\r\n          </div>\r\n      );\r\n  }\r\n}\r\n\r\nclass TitleBar extends React.Component {\r\n  render() {\r\n      return (\r\n          <div className = \"titleBar\">\r\n              <div style={{ fontSize: \"xx-large\" }}>\r\n                Honda SmartPark\r\n              </div>\r\n              <div>\r\n                  <Menu/>\r\n              </div>\r\n          </div>\r\n      );\r\n  }\r\n}\r\n\r\nclass SearchBar extends React.Component {\r\n  constructor(props) {\r\n      super(props);\r\n      this.state = {\r\n        value: '',\r\n        prevValue: ''\r\n      };\r\n  \r\n      this.handleChange = this.handleChange.bind(this);\r\n      this.handleSubmit = this.handleSubmit.bind(this);\r\n      this.onSubmit = this.props.findResults;\r\n  }\r\n\r\n  handleChange(event) {\r\n      this.setState({value: event.target.value});\r\n  }\r\n\r\n  handleSubmit(event) {\r\n      if (this.state.prevValue !== this.state.value) {\r\n        this.onSubmit(this.state.value);\r\n        this.setState({prevValue: this.state.value})\r\n      }\r\n      event.preventDefault();\r\n  }\r\n\r\n  render() {\r\n      return (\r\n          <div>\r\n              <form onSubmit={this.handleSubmit}>\r\n                  <input type=\"text\"  value={this.state.value} onChange={this.handleChange} />\r\n                  <button onClick={this.handleSubmit}>\r\n                    Search\r\n                  </button>\r\n              </form>\r\n          </div>\r\n      );\r\n  }\r\n}\r\n\r\nclass TimeBar extends React.Component {\r\n\r\n}\r\n\r\nclass Menu extends React.Component {\r\n  render() {\r\n      return (\r\n          <div>\r\n              {\"Menu\"}\r\n          </div>\r\n      );\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}